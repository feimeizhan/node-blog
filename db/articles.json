[{"_id":{"$oid":"5988a6537d84230234eb5ab1"},"title":"Everything is good enough","slug":"everything-is-good-enough","tags":["test"],"text":{"ops":[{"insert":"Javascript is the best program language of the world."},{"attributes":{"blockquote":true},"insert":"\n"},{"insert":"haha"},{"attributes":{"code-block":true},"insert":"\n"}]},"published":true,"lastModified":{"$date":"2017-08-07T17:41:39.000Z"}},
	{"_id":{"$oid":"598ac3f43af213000fe81269"},"title":"What's going on","slug":"what-is-going-on","tags":["life"],"text":{"ops":[{"insert":"When it rains it pours."},{"attributes":{"blockquote":true},"insert":"\n"}]},"published":false,"lastModified":{"$date":"2017-08-09T08:12:36.981Z"}},
	{"_id":{"$oid":"598ac4643af213000fe8126a"},"title":"Docker is worth to learning?","slug":"docker-is-worth-to-learning","tags":["docker"],"text":{"ops":[{"insert":"Obviously,it is worth."},{"attributes":{"blockquote":true},"insert":"\n"},{"insert":"There is not reason why we don't learn docker to produce something cool.\n"}]},"published":true,"lastModified":{"$date":"2017-08-09T08:14:28.286Z"}},
{"_id":{"$oid":"598b28be4f366d000689806a"},"title":"使用Docker部署Nodejs网站出现找不到node_modules问题","slug":"problem-about-create-nodejs-web-when-using-docker","tags":["docker","nodejs"],"text":{"ops":[{"insert":"我按照Nodejs官网关于如何部署网站在docker容器的"},{"attributes":{"link":"https://nodejs.org/en/docs/guides/nodejs-docker-webapp/"},"insert":"文档"},{"insert":",由于需求略作改动后，发现会因为无法找到node_modules的各项依赖而报错。\n\n"},{"attributes":{"bold":true},"insert":"Docker配置"},{"insert":"\nDockerfile:\nFROM node:boron"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"# Create app directory"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"WORKDIR /usr/src/app"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"# Install app dependencies"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"COPY package.json ."},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"RUN npm install"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"# Bundle app source"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"COPY . ."},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"EXPOSE 3000"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"# Should create Makefile in the root directory"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"CMD [ \"make\", \"start\" ]"},{"attributes":{"code-block":true},"insert":"\n"},{"insert":"具体的语句含义请查阅"},{"attributes":{"link":"https://docs.docker.com/engine/reference/builder/"},"insert":"docker官方文档"},{"insert":"\n\n按照Dockerfile文件新建镜像之后，根据镜像生成容器\ndocker run --name $(NODE_CONTAINER_NAME) -p 9999:3000 -v /project/node-blog:/usr/src/app -d $(NODE_IMAGE_NAME)"},{"attributes":{"blockquote":true},"insert":"\n"},{"insert":"\n其中/project/node-blog是宿主的路径，而/usr/src/app是容器的路径，在上面Dockerfile也有提到。执行命令之后打开搭建的网站地址，发现报着\""},{"attributes":{"italic":true},"insert":"can't find module express"},{"insert":"\"的错误。\n\n但是构建镜像的时候，打印的日志显示执行了\""},{"attributes":{"italic":true},"insert":"npm install"},{"insert":"\"，并且中间没有任何错误信息。所以我进入容器查看路径下是否存在node_modules，发现没有该文件夹，这就很奇怪了。\n\n查了官网发现如果按照上面的方法运行容器，会把宿主的 "},{"attributes":{"italic":true},"insert":"/project/node-blog "},{"insert":"路径挂载到容器的 "},{"attributes":{"italic":true},"insert":"/usr/src/app "},{"insert":"路径下，这样会导致构建镜像时执行\""},{"attributes":{"italic":true},"insert":"npm install"},{"insert":"\"产生的node_modules文件夹不存在。\n\n去掉在新建容器时挂载本地路径的语句即可\ndocker run --name $(NODE_CONTAINER_NAME) -p 9999:3000 -d $(NODE_IMAGE_NAME)"},{"attributes":{"blockquote":true},"insert":"\n"},{"insert":"\n为证明我的观点，我查阅了官方的"},{"attributes":{"link":"https://docs.docker.com/engine/tutorials/dockervolumes/#mount-a-host-directory-as-a-data-volume"},"insert":"volume文档"},{"insert":"说明和做了个"},{"attributes":{"link":"https://stackoverflow.com/a/45413240/3640083"},"insert":"小实验"},{"insert":"。\n\n以下是该"},{"attributes":{"link":"https://github.com/feimeizhan/node-blog"},"insert":"github项目"},{"insert":"供参考。\n"}]},"published":true,"lastModified":{"$date":"2017-08-09T15:22:38.659Z"}}]
